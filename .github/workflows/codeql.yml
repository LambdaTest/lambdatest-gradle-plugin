name: "CodeQL"

on:
    push:
        branches: [ "main" ]
    pull_request:
        branches: [ "main" ]

jobs:
    analyze:
        name: Analyze
        runs-on: ${{ (matrix.language == 'swift' && 'macos-latest') || 'ubuntu-latest' }}
        timeout-minutes: ${{ (matrix.language == 'swift' && 120) || 360 }}
        permissions:
            actions: read
            contents: read
            security-events: write

        strategy:
            fail-fast: false
            matrix:
                language: [ "java-kotlin" ]

        steps:
            - name: Checkout repository
              uses: actions/checkout@v3

            - name: Initialize CodeQL
              uses: github/codeql-action/init@v2
              with:
                  languages: ${{ matrix.language }}
                  queries: security-extended,security-and-quality

            # Autobuild attempts to build any compiled languages (C/C++, C#, Go, Java, or Swift).
            # If this step fails, then you should remove it and run the build manually (see below)
            - name: Autobuild
              uses: github/codeql-action/autobuild@v2
            # - run: |
            #     echo "Run, Build Application using script"
            #     ./location_of_script_within_repo/buildscript.sh

            - name: Perform CodeQL Analysis
              uses: github/codeql-action/analyze@v2
              with:
                  category: "/language:${{matrix.language}}"
